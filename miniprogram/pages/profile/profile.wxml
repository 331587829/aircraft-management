<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- A. ç”¨æˆ·ä¿¡æ¯åŒº - é‡æ–°è®¾è®¡ -->
  <view class="user-info-section">
    <view class="user-card">
      <!-- ç”¨æˆ·å¤´åƒå’ŒåŸºæœ¬ä¿¡æ¯ -->
      <view class="user-basic-info">
        <view class="user-avatar-container">
          <view class="user-avatar">
            <image src="{{userInfo.avatar}}" mode="aspectFill"></image>
            <view class="avatar-placeholder" wx:if="{{!userInfo.avatar || userInfo.avatar === '/images/user-avatar.png'}}">
              <text class="avatar-text">{{userInfo.nickName ? userInfo.nickName.charAt(0) : 'æœº'}}</text>
            </view>
          </view>
        </view>
        
        <view class="user-details">
          <view class="user-name-line">
            <text class="user-nickname">{{userInfo.nickName || 'æœºä¸»ç”¨æˆ·'}}</text>
            <view class="auth-badge {{userInfo.hasBoundAircraft ? 'authenticated' : 'pending'}}">
              <text class="badge-text">{{userInfo.hasBoundAircraft ? 'å·²è®¤è¯' : 'å¾…è®¤è¯'}}</text>
            </view>
          </view>
          <text class="user-level">{{userInfo.hasBoundAircraft ? 'VIPæœºä¸»' : 'æ™®é€šç”¨æˆ·'}}</text>
        </view>
        
        <!-- ç¼–è¾‘æŒ‰é’® -->
        <view class="edit-profile-btn" bindtap="editUserInfo">
          <text class="edit-text">ç¼–è¾‘èµ„æ–™</text>
        </view>
      </view>
      
      <!-- é£æœºç»Ÿè®¡ä¿¡æ¯ -->
      <view class="aircraft-stats">
        <view class="stat-item">
          <text class="stat-number">{{userInfo.boundAircraftCount}}</text>
          <text class="stat-label">ç»‘å®šé£æœº</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-number">{{userInfo.aircraftStatus.flying || 0}}</text>
          <text class="stat-label">æ­£å¸¸</text>
        </view>
      </view>
    </view>
  </view>

  <!-- B. æœºä¸»æœåŠ¡ï¼ˆç°ä»£åŒ–åˆ—è¡¨å¸ƒå±€ï¼‰ -->
  <view class="owner-services-section">
    <view class="section-header">
      <text class="section-title">æœºä¸»æœåŠ¡</text>
    </view>
    <view class="services-list">
      <view wx:for="{{ownerServices}}" wx:key="id" class="service-item" bindtap="onServiceClick" data-id="{{item.id}}">
        <view class="service-info">
          <text class="service-icon">{{item.icon}}</text>
          <view class="service-details">
            <text class="service-title">{{item.title}}</text>
            <text wx:if="{{item.subtitle}}" class="service-subtitle">{{item.subtitle}}</text>
          </view>
        </view>
        <view class="service-right">
          <view wx:if="{{item.badge > 0}}" class="service-badge">{{item.badge}}</view>
          <text class="service-arrow">></text>
        </view>
      </view>
      
      <!-- è”ç³»å®¢æœä½¿ç”¨å¾®ä¿¡åŸç”ŸæŒ‰é’® -->
      <button class="service-item" open-type="contact" session-from="profile">
        <view class="service-info">
          <text class="service-icon">ğŸ“</text>
          <view class="service-details">
            <text class="service-title">è”ç³»å®¢æœ</text>
            <text class="service-subtitle">24å°æ—¶åœ¨çº¿æ”¯æŒ</text>
          </view>
        </view>
        <view class="service-right">
          <text class="service-arrow">></text>
        </view>
      </button>
    </view>
  </view>

  <!-- C. æˆ‘çš„èµ„äº§åŒº -->
  <view class="assets-section">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„èµ„äº§</text>
    </view>
    <view class="assets-list">
      <view class="asset-item" bindtap="onAssetClick" data-id="aircraft">
        <view class="asset-info">
          <text class="asset-icon">âœˆï¸</text>
          <view class="asset-details">
            <text class="asset-title">æˆ‘çš„é£æœº</text>
            <text class="asset-count">{{userInfo.boundAircraftCount}}ä¸ª</text>
          </view>
        </view>
        <text class="arrow">></text>
      </view>
    </view>
  </view>

  <!-- F. å‚å®¶ç®¡ç†åŒº -->
  <view class="admin-section" wx:if="{{isAdmin}}">
    <view class="section-header">
      <text class="section-title">å‚å®¶ç®¡ç†</text>
    </view>
    <view class="admin-list">
      <view class="admin-item" bindtap="goToAdminPage">
        <view class="admin-info">
          <text class="admin-icon">âœˆï¸</text>
          <text class="admin-title">é£æœºç®¡ç†</text>
        </view>
        <text class="arrow">></text>
      </view>
      <view class="admin-item" bindtap="goToInfoManagement">
        <view class="admin-info">
          <text class="admin-icon">ğŸ“‹</text>
          <text class="admin-title">ä¿¡æ¯ç®¡ç†</text>
        </view>
        <text class="arrow">></text>
      </view>
      <view class="admin-item" bindtap="goToUserManagement">
        <view class="admin-info">
          <text class="admin-icon">ğŸ‘¥</text>
          <text class="admin-title">ç”¨æˆ·ç®¡ç†</text>
        </view>
        <text class="arrow">></text>
      </view>
    </view>
  </view>
</view>
