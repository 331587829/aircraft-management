<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <view class="header-title">
      <text class="title-text">æˆ‘çš„é£æœºçŠ¶æ€ä¸­å¿ƒ</text>
    </view>
    <button class="bind-button" type="primary" bindtap="bindNewAircraft">
      ç»‘å®šé£æœº
    </button>
  </view>

  <!-- å½“å‰é£æœºçŠ¶æ€å¡ç‰‡ -->
  <view class="status-card" wx:if="{{currentAircraft}}">
    <!-- é£æœºé€‰æ‹©å™¨ -->
    <view class="aircraft-selector">
      <view class="selector-header" bindtap="toggleAircraftSelector">
        <view class="current-aircraft-info">
          <text class="aircraft-name">{{currentAircraft.serialNumber}}</text>
          <text class="aircraft-serial">æ³¨å†Œå·: {{currentAircraft.registrationNumber || 'æœªæ³¨å†Œ'}}</text>
        </view>
        <text class="selector-arrow">{{showAircraftSelector ? 'â–²' : 'â–¼'}}</text>
      </view>
      
      <!-- é£æœºé€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ -->
      <view class="aircraft-dropdown" wx:if="{{showAircraftSelector && aircraftList.length > 1}}">
        <view class="dropdown-list">
          <view class="dropdown-item" wx:for="{{aircraftList}}" wx:key="id" bindtap="switchAircraft" data-index="{{index}}">
            <view class="item-info">
              <text class="item-model">{{item.model}}</text>
              <text class="item-serial">åºåˆ—å·: {{item.serialNumber}}</text>
            </view>
            <view class="item-status" style="background-color: {{item.statusColor}}">{{item.statusText}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- é£æœºçŠ¶æ€ä¿¡æ¯ -->
    <view class="status-info">
      <!-- çŠ¶æ€æŒ‡ç¤ºå™¨ -->
      <view class="status-indicator">
        <view class="status-badge" style="background-color: {{currentAircraft.statusColor}}">
          {{currentAircraft.statusText}}
        </view>
      </view>

      <!-- æ ¸å¿ƒä¿¡æ¯ç½‘æ ¼ -->
      <view class="info-grid">
        <view class="info-item">
          <view class="info-label">åºåˆ—å·</view>
          <view class="info-value">{{currentAircraft.serialNumber}}</view>
        </view>
        <view class="info-item">
          <view class="info-label">æ€»é£è¡Œå°æ—¶</view>
          <view class="info-value">{{currentAircraft.totalHours}} å°æ—¶</view>
        </view>
      </view>

      <!-- é£æœºç…§ç‰‡ -->
      <view class="aircraft-photo-section">
        <view class="section-title">é£æœºç…§ç‰‡</view>
        <view class="aircraft-photo-container">
          <image class="aircraft-photo" src="{{currentAircraft.image}}" mode="aspectFill" bindtap="previewAircraftImage" wx:if="{{currentAircraft.image}}"></image>
          <view class="no-photo" wx:else>
            <text class="camera-icon">ğŸ“·</text>
            <text class="no-photo-text">æš‚æ— é£æœºç…§ç‰‡</text>
          </view>
        </view>
      </view>

      <!-- é£è¡Œè®°å½•åŠŸèƒ½åŒº -->
      <view class="flight-record-section">
        <view class="section-title">é£è¡Œè®°å½•</view>
        <view class="flight-actions">
          <button class="flight-button" type="primary" bindtap="addFlightRecord">
            <text class="button-icon">âœˆï¸</text>
            <text class="button-text">æ·»åŠ è®°å½•</text>
          </button>
          <button class="flight-button" type="primary" bindtap="startFlight" wx:if="{{!isFlightInProgress}}">
            <text class="button-icon">â–¶ï¸</text>
            <text class="button-text">å¼€å§‹é£è¡Œ</text>
          </button>
          <button class="flight-button" type="warn" bindtap="endFlight" wx:if="{{isFlightInProgress}}">
            <text class="button-icon">â¹ï¸</text>
            <text class="button-text">ç»“æŸé£è¡Œ</text>
          </button>
        </view>
        <view class="current-flight" wx:if="{{isFlightInProgress}}">
          <view class="flight-timer">
            <view class="timer-icon">â±ï¸</view>
            <view class="timer-display">
              <view class="timer-label">é£è¡Œè¿›è¡Œä¸­</view>
              <view class="timer-value">{{currentFlightRecord.durationText}}</view>
              <view class="timer-hours">æ€»è®¡: {{currentFlightRecord.duration}} å°æ—¶</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ»‘åŠ¨åˆ‡æ¢åŒºåŸŸ -->
  <view class="swiper-section" wx:if="{{aircraftList.length > 1}}">
    <swiper class="aircraft-swiper" indicator-dots="{{true}}" autoplay="{{false}}" current="{{currentIndex}}" bindchange="onSwiperChange">
      <swiper-item wx:for="{{aircraftList}}" wx:key="id">
        <view class="swiper-item">
          <image class="swiper-image" src="{{item.image}}" mode="aspectFill"></image>
          <view class="swiper-info">
            <text class="swiper-model">{{item.model}}</text>
            <text class="swiper-status" style="color: {{item.statusColor}}">{{item.statusText}}</text>
          </view>
        </view>
      </swiper-item>
    </swiper>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!currentAircraft && !loading}}">
    <image class="empty-image" src="cloud://cloud1-8gaa4jfy4b22cd28.636c-cloud1-8gaa4jfy4b22cd28-1381889662/images/aircraft-icon.png"></image>
    <view class="empty-text">æš‚æ— ç»‘å®šçš„é£æœº</view>
    <view class="empty-subtext">ç‚¹å‡»å³ä¸Šè§’ç»‘å®šæ‚¨çš„é£æœº</view>
    <button class="empty-button" type="primary" bindtap="bindNewAircraft">
      ç«‹å³ç»‘å®š
    </button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>
</view>